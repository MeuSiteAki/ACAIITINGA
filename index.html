<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>A√ßaiteria Itinga</title>

  <!-- SweetAlert2 & QRCode -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


  <!-- Firebase (FireStore) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
    import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "acai123-4ad1a.firebaseapp.com",
      projectId: "acai123-4ad1a",
      storageBucket: "acai123-4ad1a.firebasestorage.app",
      messagingSenderId: "423472519123",
      appId: "1:423472519123:web:b8795b57e347f473d7c126",
      measurementId: "G-K86FBM1JE5"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);

    async function salvarPedido(pedido) {
      try {
        await addDoc(collection(db, "pedidos"), pedido);
        console.log("‚úÖ Pedido salvo no Firestore");
      } catch (e) {
        console.error("‚ùå Erro ao salvar pedido:", e);
      }
    }

    const pedidosRef = collection(db, "pedidos");
    onSnapshot(pedidosRef, (snapshot) => {
      snapshot.docChanges().forEach((change) => {
        if (change.type === "added") {
          console.log("üì• Novo pedido:", change.doc.data());
        }
      });
    });

    window.__db = db;
    window.__salvarPedido = salvarPedido;
  </script>

  <style>
    :root{
      --primary:#2ecc71; --primary-dark:#27ae60; --accent:#f1c40f; --danger:#e74c3c;
      --bg:#f6fff8; --text:#2d3142; --muted:#7786a5; --card:#ffffff; --shadow:0 8px 20px rgba(0,0,0,0.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#eaffea,var(--bg));color:var(--text)}

    /* Header com logo elegante */
    header{position:sticky;top:0;z-index:10;background:linear-gradient(90deg,var(--primary),var(--primary-dark));color:#fff;padding:12px 20px;box-shadow:var(--shadow);display:flex;align-items:center;gap:12px}
    .logo-wrap{display:flex;align-items:center;gap:12px}
    .logo-img{width:110px;height:110px;border-radius:22px;object-fit:cover;box-shadow:0 8px 18px rgba(0,0,0,0.35);border:2px solid rgba(255,255,255,0.35);animation:zoomIn 1.2s ease}
    @keyframes zoomIn{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
    .brand{font-size:28px;font-weight:800;letter-spacing:0.6px}

    .container{max-width:1024px;margin:20px auto;padding:0 16px 110px}

    .card{border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;margin-bottom:16px;color:#fff}
    .theme-green{background:linear-gradient(135deg,#2ecc71,#27ae60)}
    .theme-blue{background:linear-gradient(135deg,#3498db,#2980b9)}
    .theme-purple{background:linear-gradient(135deg,#9b59b6,#8e44ad)}
    .theme-orange{background:linear-gradient(135deg,#f39c12,#d35400)}
    .theme-red{background:linear-gradient(135deg,#e74c3c,#c0392b)}
    .card h3{margin:0 0 10px;font-size:22px}

    /* Tamanhos */
    .sizes{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .size{background:#fff;color:#2d3142;border-radius:14px;padding:12px;text-align:center;font-weight:700;box-shadow:var(--shadow)}
    .size img{width:64px;height:64px;margin-bottom:6px;border-radius:50%;filter:drop-shadow(0 6px 10px rgba(0,0,0,0.15))}
    .size .sub{font-size:12px;color:#556}
    .size .price{margin-top:4px;color:#1b1f2a}
    .size input{margin-top:8px;width:26px;height:26px;accent-color:var(--primary)}

    /* Toggle sizes (maior/centralizado) */
    .toggle-wrap{display:flex;justify-content:center;margin:0 0 16px}
    .toggle-btn{display:inline-flex;align-items:center;gap:10px;padding:16px 28px;border:none;border-radius:999px;background:linear-gradient(135deg,#13790f,#1ca354);color:#fff;font-weight:800;font-size:18px;cursor:pointer;box-shadow:0 10px 24px rgba(0,0,0,0.18);transition:.25s}
    .toggle-btn:hover{transform:scale(1.05)}

    .options{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
    .option{background:#fff;color:#2d3142;border-radius:12px;padding:10px;display:flex;align-items:center;gap:10px;font-weight:600;box-shadow:var(--shadow)}
    .option.disabled{opacity:.5;pointer-events:none}
    input[type=checkbox],input[type=radio]{width:26px;height:26px;accent-color:var(--primary);cursor:pointer}

    .input textarea,.input input,.input select{width:100%;border:2px solid #eaeef5;border-radius:10px;padding:10px;font-size:14px;outline:none;background:#fff;color:#2d3142}
    .input textarea:focus,.input input:focus,.input select:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(39,174,96,0.12)}

    .actions{display:flex;gap:12px;flex-wrap:wrap}
    .btn{border:none;border-radius:999px;padding:12px 16px;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;gap:8px;box-shadow:var(--shadow)}
    .btn.primary{background:var(--primary);color:#fff}
    .btn.secondary{background:var(--accent);color:#3b2400}
    .btn.ghost{background:#fff;color:#27ae60;border:2px solid #eee}
    .btn.whatsapp{background:#25D366;color:#fff;font-size:16px;justify-content:center;width:100%}

    .fab-cart{position:fixed;bottom:16px;right:16px;background:linear-gradient(135deg,var(--accent),#ffe58a);color:#3b2400;border-radius:999px;padding:14px 16px;display:inline-flex;align-items:center;gap:8px;box-shadow:0 18px 35px rgba(0,0,0,0.18);font-weight:800;border:none;cursor:pointer;z-index:9}

    /* Carrinho com espa√ßamento reduzido */
    .cart-panel{position:fixed;top:0;right:0;width:min(460px,92vw);height:100vh;background:#ffffff;box-shadow:-12px 0 24px rgba(0,0,0,0.14);transform:translateX(105%);transition:transform .3s ease;z-index:10;display:grid;border-left:6px solid var(--accent)}
    .cart-panel.open{transform:translateX(0)}
    .cart-header{padding:10px 12px;background:linear-gradient(90deg,var(--primary),var(--primary-dark));color:#fff;display:flex;align-items:center;justify-content:space-between;font-weight:800}
    .cart-items{padding:8px;overflow:auto;display:grid;gap:3px;background:#f9fdf9}
    .cart-item{background:#fff;border:1px solid #eef1f5;border-radius:10px;padding:6px;box-shadow:var(--shadow);display:grid;gap:2px}
    .cart-item .top{display:flex;justify-content:space-between;align-items:center}
    .cart-title{font-weight:800;color:#1b1f2a;font-size:14px}
    .cart-price{font-weight:800;color:#1b1f2a;font-size:14px}
    .list-row{font-size:12px;color:#334;line-height:1.2}
    .remove{align-self:flex-end;background:#ffecec;border:1px solid #ffd0d0;color:var(--danger);border-radius:8px;padding:2px 6px;font-weight:700;cursor:pointer;font-size:12px}
    .empty{text-align:center;color:var(--muted);padding:10px}
    .total-bar{background:#fff;padding:5px;font-weight:800;text-align:right;border-top:1px solid #eef1f5}

    .form{padding:10px;display:grid;gap:8px;overflow-y:auto;max-height:240px}
    .label{font-size:12px;color:var(--muted);margin-bottom:4px}

    footer{background:linear-gradient(90deg,#27ae60,#2ecc71);color:#fff;text-align:center;padding:20px 16px}
    footer .row{max-width:1024px;margin:0 auto;display:grid;gap:8px}
    footer .social{margin-top:10px;display:flex;justify-content:center;gap:16px}
    footer a{color:#fff;text-decoration:none;font-weight:700;transition:.2s}
    footer a:hover{color:#ffe58a}

    .toast{position:fixed;bottom:25px;left:50%;transform:translateX(-50%);background:#fff;padding:16px 22px;border-radius:14px;box-shadow:var(--shadow);font-size:16px;font-weight:700;border:2px solid var(--primary);animation:fadeInOut 2.5s ease forwards;z-index:50}
    @keyframes fadeInOut{0%{opacity:0;transform:translate(-50%,14px)}10%{opacity:1;transform:translate(-50%,0)}85%{opacity:1}100%{opacity:0;transform:translate(-50%,14px)}}

    @media(max-width:640px){.sizes{grid-template-columns:1fr 1fr}}
    @media(max-width:420px){.sizes{grid-template-columns:1fr}}
    .cart-body {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  background: #f9fdf9;
  border-radius: 12px;
  margin: 8px;
}

.cart-items {
  flex-grow: 1;
  overflow-y: auto;
  padding: 8px;
  display: grid;
  gap: 6px;
}

.cart-item {
  background: #fff;
  border: 1px solid #eef1f5;
  border-radius: 12px;
  padding: 10px;
  box-shadow: var(--shadow);
  transition: transform 0.2s ease;
}
.cart-item:hover {
  transform: scale(1.02);
}

.cart-title {
  font-weight: 800;
  font-size: 15px;
  color: #1b1f2a;
}
.cart-price {
  font-weight: 800;
  font-size: 15px;
  color: #108600;
}
.remove {
  align-self: flex-end;
  background: #ffecec;
  border: 1px solid #ffd0d0;
  color: var(--danger);
  border-radius: 8px;
  padding: 4px 8px;
  font-weight: 700;
  cursor: pointer;
  font-size: 14px;
}
.total-bar {
  background: #f0fff0;
  padding: 12px;
  font-weight: 800;
  text-align: right;
  font-size: 18px;
  border-top: 2px solid #eaeef5;
  color: #108600;
}
.cart-panel {
  position: fixed;
  top: 0;
  right: 0;
  width: min(400px, 90vw);
  height: 92vh;
  background: #fdf9ff;
  box-shadow: -12px 0 24px rgba(0, 0, 0, 0.14);
  transform: translateX(105%);
  transition: transform 0.3s ease;
  z-index: 10;
  display: flex;
  flex-direction: column;
  border-left: 6px solid #9b59b6;
  border-radius: 16px 0 0 16px;
}

.cart-panel.open {
  transform: translateX(0);
}

.cart-header {
  padding: 16px;
  background: linear-gradient(90deg, #9b59b6, #8e44ad);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 800;
  border-radius: 16px 0 0 0;
}

.cart-body {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  background: #f9fdf9;
  padding: 8px;
  overflow: hidden;
}

.cart-items {
  flex-grow: 1;
  overflow-y: auto;
  padding-right: 4px;
  display: grid;
  gap: 6px;
}

.cart-item {
  background: #fff;
  border: 1px solid #eef1f5;
  border-radius: 12px;
  padding: 10px;
  box-shadow: var(--shadow);
  transition: transform 0.2s ease;
}
.cart-item:hover {
  transform: scale(1.02);
}

.cart-title {
  font-weight: 800;
  font-size: 15px;
  color: #1b1f2a;
}
.cart-price {
  font-weight: 800;
  font-size: 15px;
  color: #8e44ad;
}
.remove {
  align-self: flex-end;
  background: #fce4ec;
  border: 1px solid #f8bbd0;
  color: #c2185b;
  border-radius: 8px;
  padding: 4px 8px;
  font-weight: 700;
  cursor: pointer;
  font-size: 14px;
}
.total-bar {
  background: #f3e5f5;
  padding: 12px;
  font-weight: 800;
  text-align: right;
  font-size: 18px;
  border-top: 2px solid #eaeef5;
  color: #8e44ad;
}

  </style>
</head>
<body>
  <header>
    <div class="logo-wrap">
      <img src="a√ßai2.jpeg" alt="Logo A√ßaiteria" class="logo-img">
      <div class="brand">A√ßaiteria Itinga</div>
    </div>
  </header>

  <main class="container">
    <!-- Bot√£o para mostrar/ocultar tamanhos (centralizado, maior) -->
    <div class="toggle-wrap">
      <button class="toggle-btn" id="toggleSizes"><u>Mostrar tamanho do copo</u></button>
    </div>

    <section class="card theme-green" id="sizesCard" style="display:none;">
      <h3>Tamanho do copo</h3>
      <div class="sizes" id="sizeGroup">
        <label class="size">
          <img src="a√ßai.jpg" alt="Copo 300"/><br>
          300ml<br><span class="sub">2 frutas ‚Ä¢ 2 ingredientes ‚Ä¢ 1 cobertura</span>
          <div class="price"><strong style="font-size: 20px; color: #108600;">R$ 10,00</strong></div>
          <input type="radio" name="size" value="300" data-price="10">
        </label>
        <label class="size">
          <img src="a√ßai.jpg" alt="Copo 400"/><br>
          400ml<br><span class="sub">3 frutas ‚Ä¢ 3 ingredientes ‚Ä¢ 1 cobertura</span>
          <div class="price"><strong style="font-size: 20px; color: #108600;">R$ 15,00</strong></div>
          <input type="radio" name="size" value="400" data-price="15">
        </label>
        <label class="size">
          <img src="a√ßai.jpg" alt="Copo 500"/><br>
          500ml<br><span class="sub">4 frutas ‚Ä¢ 4 ingredientes ‚Ä¢ 1 cobertura</span>
          <div class="price"><strong style="font-size: 20px; color: #108600;">R$ 20,00</strong></div>
          <input type="radio" name="size" value="500" data-price="20">
        </label>
      </div>
    </section>

    <section class="card theme-blue" id="fruitsSection">
      <h3><i class="fas fa-apple-alt"></i> Frutas</h3>
      <div class="options" id="fruits"></div>
    </section>

    <section class="card theme-purple">
      <h3><i class="fas fa-seedling"></i> Ingredientes</h3>
      <div class="options" id="ingredients"></div>
    </section>

    <section class="card theme-orange">
      <h3><i class="fas fa-ice-cream"></i> Cobertura</h3>
      <div class="options" id="toppings"></div>
      <div class="input" style="margin-top:8px;">
        <span class="label">Opcional ‚Äî escolha se quiser.</span>
      </div>
    </section>

    <section class="card theme-red">
      <h3><i class="fas fa-comment-dots"></i> Observa√ß√µes</h3>
      <div class="input">
        <textarea id="notes" rows="3" placeholder="Ex.: pouco xarope, sem granola, ponto do a√ßa√≠‚Ä¶ (opcional)"></textarea>
      </div>
      <div class="actions" style="margin-top:10px;">
        <button class="btn primary" id="addToCart">Adicionar ao carrinho</button>
        <button class="btn ghost" id="reset">Limpar escolhas</button>
      </div>
    </section>
  </main>

  <button class="fab-cart" id="toggleCart"> <i class="fas fa-shopping-cart"></i> Abrir carrinho</button>

  <aside class="cart-panel" id="cartPanel">
  <div class="cart-header">
    <strong>üõí Seu carrinho</strong>
    <button class="btn secondary" id="closeCart">Fechar</button>
  </div>

  <div class="cart-body">
    <div class="cart-items" id="cartItems">
      <div class="empty">Seu carrinho est√° vazio. Adicione um a√ßa√≠ para come√ßar.</div>
    </div>
    <div class="total-bar" id="totalBar">Total: R$ 0,00</div>
  </div>

  <div class="form">
    <div class="input"><span class="label">Nome</span><input id="name" type="text" placeholder="Seu nome" required></div>
    <div class="input"><span class="label">Telefone</span><input id="phone" type="tel" placeholder="(99) 9 9999-9999" required></div>
    <div class="input"><span class="label">Endere√ßo</span><input id="address" type="text" placeholder="Rua, n√∫mero" required></div>
    <div class="input">
      <span class="label">Bairro</span>
      <select id="neighborhood" required>
        <option value="" selected disabled>Bairro</option>
        <option value="Centro">Centro</option>
        <option value="Coqueiral">Coqueiral</option>
        <option value="Vila Emanuela">Vila Emanuela</option>
        <option value="C√©lio Braz">C√©lio Braz</option>
        <option value="Vila Samuel">Vila Samuel</option>
        <option value="Jardim Planalto">Jardim Planalto</option>
        <option value="Parq. Primavera">Parq. Primavera</option>
        <option value="S√£o Sebasti√£o">S√£o Sebasti√£o</option>
        <option value="Paraiso">Paraiso</option>
        <option value="S√£o Jo√£o">S√£o Jo√£o</option>
        <option value="Vila Jamily">Vila Jamily</option>
        <option value="Itinga-PA">Itinga-PA</option>
        <option value="Paulist√£o">Paulist√£o</option>
      </select>
    </div>
    <div class="input">
      <span class="label">Forma de pagamento</span>
      <select id="payment" required>
        <option value="" selected disabled>Selecione</option>
        <option>Dinheiro</option>
        <option>Cart√£o</option>
        <option>Pix</option>
      </select>
    </div>
    <div class="actions" style="justify-content:flex-end;">
      <button class="btn whatsapp" id="sendWhatsapp">Enviar pedido no WhatsApp</button>
    </div>
    <div class="label" style="text-align:right;">Envio para: 55 99 9224-7544</div>
  </div>
</aside>



  <footer>
    <div class="row">
      <div><strong>¬© 2025 A√ßaiteria Itinga</strong> ‚Äî Feito com üíö em Itinga do Maranh√£o, MA.</div>
      <div class="social">
        <a href="#" aria-label="Instagram">Instagram</a>
        <a href="#" aria-label="Facebook">Facebook</a>
        <a href="#" aria-label="WhatsApp">WhatsApp</a>
      </div>
    </div>
  </footer>

  <script>
    // Dados
    const FRUITS = ["Banana","Morango","Manga","Kiwi","Uva","Abacaxi"];
    const INGREDIENTS = ["Granola","Leite em p√≥","Pa√ßoca","Amendoim","Jujuba","Castanha"];
    const TOPPINGS = ["Chocolate","Caramelo","Leite condensado","Morango"];

    const EMOJI = {
      Banana:"üçå", Morango:"üçì", Manga:"ü•≠", Kiwi:"ü•ù", Uva:"üçá", Abacaxi:"üçç",
      Granola:"ü•£", "Leite em p√≥":"ü•õ", Pa√ßoca:"ü•ú", Amendoim:"ü•ú", Jujuba:"üç¨", Castanha:"üå∞"
    };

    // PIX Config
    const PIX_KEY = '+5599992247544';
    const PIX_NAME = 'Carlos de Freitas Rocha';
    const PIX_BANK = 'Banco do Brasil';
    const PIX_CITY = 'IMPERATRIZ';

    // Elementos
    const sizeRadios = document.querySelectorAll('input[name="size"]');
    const fruitsWrap = document.getElementById('fruits');
    const ingredientsWrap = document.getElementById('ingredients');
    const toppingsWrap = document.getElementById('toppings');

    const toggleSizesBtn = document.getElementById('toggleSizes');
    const sizesCard = document.getElementById('sizesCard');

    const addToCartBtn = document.getElementById('addToCart');
    const resetBtn = document.getElementById('reset');

    const cartPanel = document.getElementById('cartPanel');
    const toggleCartBtn = document.getElementById('toggleCart');
    const closeCartBtn = document.getElementById('closeCart');
    const cartItems = document.getElementById('cartItems');
    const totalBar = document.getElementById('totalBar');

    const nameInput = document.getElementById('name');
    const phoneInput = document.getElementById('phone');
    const addressInput = document.getElementById('address');
    const neighborhoodInput = document.getElementById('neighborhood');
    const paymentInput = document.getElementById('payment');
    const sendWhatsappBtn = document.getElementById('sendWhatsapp');

    const fruitsSection = document.getElementById('fruitsSection');

    // Estado
    let limits = { fruits: 0, ingredients: 0 };
    let cart = [];

    // Render options (sem √≠cones visuais na UI)
    function createOption(labelText, name, type = "checkbox") {
      const d = document.createElement('label');
      d.className = 'option';
      d.innerHTML = `<input type="${type}" name="${name}" value="${labelText}"> ${labelText}`;
      return d;
    }
    FRUITS.forEach(f => fruitsWrap.appendChild(createOption(f, 'fruits')));
    INGREDIENTS.forEach(i => ingredientsWrap.appendChild(createOption(i, 'ingredients')));
    TOPPINGS.forEach(t => toppingsWrap.appendChild(createOption(t, 'toppings', 'radio')));

    // Nenhum radio marcado ao abrir
    sizeRadios.forEach(r => r.checked = false);
    toppingsWrap.querySelectorAll('input[name="toppings"]').forEach(t => t.checked = false);

    // Toggle de tamanhos
    toggleSizesBtn.addEventListener('click', () => {
      const visible = sizesCard.style.display !== 'none';
      sizesCard.style.display = visible ? 'none' : 'block';
      toggleSizesBtn.textContent = visible ? 'Mostrar tamanho do copo' : 'Ocultar tamanho do copo';
    });

    // Limites por tamanho
    function updateLimitsFromSize() {
      const selected = document.querySelector('input[name="size"]:checked')?.value;
      if (selected === '300') limits = { fruits: 2, ingredients: 2 };
      else if (selected === '400') limits = { fruits: 3, ingredients: 3 };
      else if (selected === '500') limits = { fruits: 4, ingredients: 4 };
      else limits = { fruits: 0, ingredients: 0 };
      enforceLimits('fruits', limits.fruits);
      enforceLimits('ingredients', limits.ingredients);
    }

    // Ao escolher tamanho, reset e rolar at√© frutas
    sizeRadios.forEach(r => r.addEventListener('change', () => {
      resetSelections(true);
      r.checked = true;
      updateLimitsFromSize();
      fruitsSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }));
    updateLimitsFromSize();

    function enforceLimits(groupName, max) {
      const inputs = document.querySelectorAll(`input[name="${groupName}"]`);
      const selectedCount = Array.from(inputs).filter(i => i.checked).length;
      inputs.forEach(i => {
        if (max === 0) {
          i.closest('.option').classList.add('disabled');
          i.checked = false;
        } else {
          if (!i.checked) i.closest('.option').classList.toggle('disabled', selectedCount >= max);
          else i.closest('.option').classList.remove('disabled');
        }
      });
    }

    // Toast com emoji (apenas no aviso)
    function showToast(text, emoji = '') {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = `${emoji ? emoji + ' ' : ''}${text} adicionado`;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2500);
    }

    ['fruits','ingredients'].forEach(group => {
      document.querySelectorAll(`input[name="${group}"]`).forEach(inp => {
        inp.addEventListener('change', () => {
          const max = group === 'fruits' ? limits.fruits : limits.ingredients;
          const inputs = document.querySelectorAll(`input[name="${group}"]`);
          const count = Array.from(inputs).filter(i => i.checked).length;
          if (count > max) {
            inp.checked = false;
          } else if (inp.checked) {
            const emoji = EMOJI[inp.value] || '';
            showToast(inp.value, emoji);
          }
          enforceLimits(group, max);
        });
      });
    });

    function openCart(){cartPanel.classList.add('open');toggleCartBtn.textContent='Fechar carrinho'}
    function closeCart(){cartPanel.classList.remove('open');toggleCartBtn.textContent='Abrir carrinho'}
    toggleCartBtn.addEventListener('click',()=>cartPanel.classList.contains('open')?closeCart():openCart());
    closeCartBtn.addEventListener('click',closeCart);

    addToCartBtn.addEventListener('click', () => {
      const sizeInput = document.querySelector('input[name="size"]:checked');
      const size = sizeInput?.value;
      const price = Number(sizeInput?.dataset?.price || 0);
      const fruits = Array.from(document.querySelectorAll('input[name="fruits"]:checked')).map(i => i.value);
      const ingredients = Array.from(document.querySelectorAll('input[name="ingredients"]:checked')).map(i => i.value);
      const topping = document.querySelector('input[name="toppings"]:checked')?.value || '';
      const notes = document.getElementById('notes').value.trim();

      if (!size) return alert('Escolha um tamanho.');

      const item = { id: Date.now(), size, price, fruits, ingredients, topping, notes };
      cart.push(item);
      renderCart();
      openCart();
      showToast(`Copo ${size}ml`);
      resetSelections(false);
    });

    function resetSelections(full = true) {
      ['fruits','ingredients'].forEach(group => {
        document.querySelectorAll(`input[name="${group}"]`).forEach(i => i.checked = false);
        enforceLimits(group, limits[group]);
      });
      if (full) {
        document.querySelectorAll('input[name="size"]').forEach(r => r.checked = false);
        document.querySelectorAll('input[name="toppings"]').forEach(t => t.checked = false);
        updateLimitsFromSize();
      }
      document.getElementById('notes').value = '';
    }
    resetBtn.addEventListener('click',()=>resetSelections(true));

    function formatBRL(n){return n.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})}
    function renderCart(){
      cartItems.innerHTML='';
      if(cart.length===0){
        cartItems.innerHTML='<div class="empty">Seu carrinho est√° vazio. Adicione um a√ßa√≠ para come√ßar.</div>';
        updateTotalBar(); return;
      }
      cart.forEach(item=>{
        const div=document.createElement('div');
        div.className='cart-item';
        div.innerHTML=`
          <div class="top">
            <div class="cart-title">Copo ${item.size}ml</div>
            <div class="cart-price">${formatBRL(item.price)}</div>
          </div>
          <div class="list-row"><strong>Frutas:</strong> ${item.fruits.join(', ') || '-'}</div>
          <div class="list-row"><strong>Ingredientes:</strong> ${item.ingredients.join(', ') || '-'}</div>
          <div class="list-row"><strong>Cobertura:</strong> ${item.topping || '-'}</div>
          ${item.notes ? `<div class="list-row"><strong>Obs.:</strong> ${item.notes}</div>` : ''}
          <button class="remove" data-id="${item.id}">Remover</button>
        `;
        cartItems.appendChild(div);
      });
      cartItems.querySelectorAll('.remove').forEach(btn=>{
        btn.addEventListener('click',e=>{
          const id=Number(e.currentTarget.getAttribute('data-id'));
          cart=cart.filter(i=>i.id!==id);
          renderCart();
        });
      });
      updateTotalBar();
    }
    function updateTotalBar(){
      const total=cart.reduce((s,i)=>s+i.price,0);
      totalBar.textContent=`Total: ${formatBRL(total)}`;
      sendWhatsappBtn.disabled=cart.length===0;
    }

    phoneInput.addEventListener('input',()=>{
      let v=phoneInput.value.replace(/\D/g,'');
      v=v.replace(/^(\d{2})(\d)/,'($1) $2').replace(/(\d{5})(\d)/,'$1-$2');
      phoneInput.value=v.slice(0,15);
    });

    paymentInput.addEventListener('change',async ()=>{
      const total=cart.reduce((sum,i)=>sum+i.price,0);
      const val=paymentInput.value;

      if(val==='Pix'){
        if(total<=0){
          await Swal.fire({icon:'info',title:'Carrinho vazio',text:'Adicione itens para gerar o Pix.'});
          paymentInput.value='';return;
        }
        const code=buildPixBRCode({key:PIX_KEY,name:PIX_NAME,city:PIX_CITY,amount:total,txid:'ACAI'});
        const canvas=document.createElement('canvas');
        await QRCode.toCanvas(canvas,code,{width:220});
        const dataUrl=canvas.toDataURL();

        Swal.fire({
          title:'Pagamento via Pix',
          html:`
            <div style="display:grid;gap:12px;place-items:center">
              <img src="${dataUrl}" alt="QR Pix" style="width:220px;height:220px;border:1px solid #eee;border-radius:8px"/>
              <div style="display:flex;gap:8px;width:100%;">
                <textarea id="pixCodeTA" readonly style="flex:1;height:100px;font-size:12px;">${code}</textarea>
                <button id="copyPixBtn" class="swal2-confirm swal2-styled" style="background:#2ecc71;white-space:nowrap;">Copiar</button>
              </div>
              <small style="color:#7786a5">Copie o c√≥digo de pagamento e cole no seu app do banco.</small>
            </div>
          `,
          width:520,
          showConfirmButton:false,
          didOpen:()=>{
            const btn=document.getElementById('copyPixBtn');
            btn?.addEventListener('click',async()=>{
              const ta=document.getElementById('pixCodeTA');
              await navigator.clipboard.writeText(ta.value);
              Swal.fire({toast:true,position:'top',icon:'success',title:'C√≥digo Pix copiado',showConfirmButton:false,timer:1800});
            });
          }
        });
      }

      if(val==='Dinheiro'){
        if(total<=0){
          await Swal.fire({icon:'info',title:'Carrinho vazio',text:'Adicione itens para calcular o troco.'});
          paymentInput.value='';return;
        }
        const {value:cash}=await Swal.fire({
          title:'Valor em dinheiro',
          input:'number',
          inputLabel:`Total: ${formatBRL(total)} ‚Äî informe o valor entregue`,
          inputAttributes:{step:'0.01',min:String(total)},
          confirmButtonText:'Calcular troco',
          showCancelButton:true
        });
        if(cash!==undefined&&cash!==null&&cash!==''){
          const value=parseFloat(cash);
          if(isNaN(value)||value<total){
            await Swal.fire({icon:'warning',title:'Valor insuficiente',text:'O valor entregue √© menor que o total.'});
            paymentInput.value='';return;
          }
          const troco=value-total;
          const notesEl=document.getElementById('notes');
          const prefix=notesEl.value.trim()?notesEl.value.trim()+' | ':'';
          notesEl.value=`${prefix}Troco para: ${formatBRL(value)} (troco: ${formatBRL(troco)})`;
          await Swal.fire({icon:'success',title:'Troco calculado',text:`Troco: ${formatBRL(troco)}. Observa√ß√£o atualizada.`});
        } else {
          paymentInput.value='';
        }
      }
    });

    // WhatsApp + Firestore
    sendWhatsappBtn.addEventListener('click',()=>{
      if(cart.length===0)return alert('Adicione pelo menos um a√ßa√≠ ao carrinho.');
      if(!nameInput.value.trim())return alert('Informe seu nome.');
      if(!phoneInput.value.trim())return alert('Informe seu telefone.');
      if(!addressInput.value.trim())return alert('Informe seu endere√ßo.');
      if(!neighborhoodInput.value)return alert('Informe seu bairro.');
      if(!paymentInput.value)return alert('Selecione a forma de pagamento.');

      const total=cart.reduce((sum,i)=>sum+i.price,0);

      const itemsText=cart.map((item,idx)=>[
        `#${idx+1}`,
        `‚Ä¢ Copo: ${item.size}ml`,
        `‚Ä¢ Pre√ßo: ${formatBRL(item.price)}`,
        `‚Ä¢ Frutas: ${item.fruits.join(', ')||'-'}`,
        `‚Ä¢ Ingredientes: ${item.ingredients.join(', ')||'-'}`,
        `‚Ä¢ Cobertura: ${item.topping||'-'}`,
        item.notes?`‚Ä¢ Observa√ß√µes do item: ${item.notes}`:null
      ].filter(Boolean).join('\n')).join('\n\n');

      const customerFields=[
        `Cliente: ${nameInput.value.trim()}`,
        `Telefone: ${phoneInput.value.trim()}`,
        `Endere√ßo: ${addressInput.value.trim()}`,
        `Bairro: ${neighborhoodInput.value}`,
        `Pagamento: ${paymentInput.value}`
      ].join('\n');

      const extraObs = document.getElementById('notes').value.trim()
        ? `\nObserva√ß√µes gerais: ${document.getElementById('notes').value.trim()}`
        : '';

      const message=[
        'Pedido ‚Äî A√ßaiteria Itinga',
        '==============================',
        itemsText,
        '==============================',
        `Total: ${formatBRL(total)}`,
        '',
        customerFields + extraObs
      ].join('\n');

      const phone='559992247544';
      const url=`https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(url,'_blank');

      const pedido = {
        cliente: nameInput.value.trim(),
        telefone: phoneInput.value.trim(),
        endereco: addressInput.value.trim(),
        bairro: neighborhoodInput.value,
        pagamento: paymentInput.value,
        observacoes: document.getElementById('notes').value.trim(),
        itens: cart,
        total,
        data: new Date().toISOString()
      };
      window.__salvarPedido?.(pedido);

      setTimeout(()=>location.reload(),1000);
    });

    // Helpers: Pix BR Code (EMV)
    function buildPixBRCode({key,name,city,amount,txid='ACAI'}){
      const tlv=(id,value)=>id+String(value.length).padStart(2,'0')+value;
      const gui=tlv('00','BR.GOV.BCB.PIX');
      const mAccountInfo=tlv('26',gui+tlv('01',key));
      const mc=tlv('52','0000');
      const cur=tlv('53','986');
      const amt=tlv('54',Number(amount).toFixed(2));
      const cc=tlv('58','BR');
      const nm=tlv('59',(name||'').slice(0,25));
      const ct=tlv('60',(city||'').slice(0,15));
      const add=tlv('62',tlv('05',(txid||'').slice(0,25)));
      const pfi=tlv('00','01');
      const poi=tlv('01','12');
      let payload=pfi+poi+mAccountInfo+mc+cur+amt+cc+nm+ct+add;
      payload+='63'+'04';
      const crc=crc16(payload);
      payload+=crc;
      return payload;
    }
    function crc16(payload){
      let crc=0xFFFF;const poly=0x1021;
      const bytes=new TextEncoder().encode(payload);
      for(let b of bytes){crc^=(b<<8);for(let i=0;i<8;i++){if(crc&0x8000){crc=(crc<<1)^poly}else{crc=(crc<<1)}crc&=0xFFFF}}
      return crc.toString(16).toUpperCase().padStart(4,'0');
    }
  </script>
</body>
</html>





<!-- // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBA4Vw5sqCEcrOfU61HTa4XZWRqsMuvUzg",
  authDomain: "acai123-4ad1a.firebaseapp.com",
  projectId: "acai123-4ad1a",
  storageBucket: "acai123-4ad1a.firebasestorage.app",
  messagingSenderId: "423472519123",
  appId: "1:423472519123:web:b8795b57e347f473d7c126",
  measurementId: "G-K86FBM1JE5"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app); -->